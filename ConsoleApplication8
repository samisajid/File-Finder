#include <iostream>
#include <string>
#include <boost/filesystem.hpp>
using namespace std;
using namespace boost::filesystem;

string getFileName(const string& s) {

	char sep = '/';

#ifdef _WIN32
	sep = '\\';
#endif

	size_t i = s.rfind(sep, s.length());
	if (i != string::npos) {
		return(s.substr(i + 1, s.length() - i));
	}

	return("");
}

int main(int argc, char* argv[])
{
	if (argc < 3)
	{
		cout << "Usage: tut3 path\n";
		return 1;
	}

	path p(argv[2]);
	try
	{
		if (exists(p))
		{
			if (is_regular_file(p))
				cout << p << " size is " << file_size(p) << '\n';

			else if (is_directory(p))
			{
				cout << p << " is a directory containing:\n";

				for (directory_entry& x : recursive_directory_iterator(p)) {
					if (getFileName(x.path().string()).find(argv[1]) != string::npos) {
						cout << "There is " << x.path() << endl;
					}

				}
			}
			else
				cout << p << " exists, but is not a regular file or directory\n";
		}
		else
			cout << p << " does not exist\n";
	}

	catch (const filesystem_error& ex)
	{
		cout << ex.what() << '\n';
	}

	return 0;
}
